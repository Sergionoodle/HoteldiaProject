#pragma checksum "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor" "{8829d00f-11b8-4213-878b-770e8597ac16}" "b75f4d6d9187c60abad3ff4a01fc92a32073077de2fa421d7e5c6041ce4d6060"
// <auto-generated/>
#pragma warning disable 1591
namespace Hoteldia.Components.Account.Pages.Manage
{
    #line default
    using global::System;
    using global::System.Collections.Generic;
    using global::System.Linq;
    using global::System.Threading.Tasks;
    using global::Microsoft.AspNetCore.Components;
#nullable restore
#line (1,2)-(1,23) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\_Imports.razor"
using System.Net.Http

#nullable disable
    ;
#nullable restore
#line (2,2)-(2,28) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\_Imports.razor"
using System.Net.Http.Json

#nullable disable
    ;
#nullable restore
#line (3,2)-(3,53) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization

#nullable disable
    ;
#nullable restore
#line (4,2)-(4,45) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms

#nullable disable
    ;
#nullable restore
#line (5,2)-(5,47) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing

#nullable disable
    ;
#nullable restore
#line (6,2)-(6,43) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\_Imports.razor"
using Microsoft.AspNetCore.Components.Web

#nullable disable
    ;
#nullable restore
#line (7,2)-(7,61) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\_Imports.razor"
using static Microsoft.AspNetCore.Components.Web.RenderMode

#nullable disable
    ;
#nullable restore
#line (8,2)-(8,58) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization

#nullable disable
    ;
#nullable restore
#line (9,2)-(9,27) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\_Imports.razor"
using Microsoft.JSInterop

#nullable disable
    ;
#nullable restore
#line (10,2)-(10,16) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\_Imports.razor"
using Hoteldia

#nullable disable
    ;
#nullable restore
#line (11,2)-(11,27) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\_Imports.razor"
using Hoteldia.Components

#nullable disable
    ;
#nullable restore
#line (12,2)-(12,26) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\_Imports.razor"
using Hoteldia.Servicios

#nullable disable
    ;
#nullable restore
#line (1,2)-(1,42) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\_Imports.razor"
using Hoteldia.Components.Account.Shared

#nullable disable
    ;
#nullable restore
#line (3,2)-(3,42) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
using Microsoft.AspNetCore.Http.Features

#nullable disable
    ;
#nullable restore
#line (4,2)-(4,37) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
using Microsoft.AspNetCore.Identity

#nullable disable
    ;
#nullable restore
#line (5,2)-(5,21) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
using Hoteldia.Data

#nullable disable
    ;
    #line default
    #line hidden
#nullable restore
#line (2,12)-(2,43) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\_Imports.razor"
[ExcludeFromInteractiveRouting]

#line default
#line hidden
#nullable disable

#nullable restore
#line (2,12)-(2,58) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\_Imports.razor"
[Microsoft.AspNetCore.Authorization.Authorize]

#line default
#line hidden
#nullable disable

    [global::Microsoft.AspNetCore.Components.LayoutAttribute(typeof(
#nullable restore
#line (1,9)-(1,21) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\_Imports.razor"
ManageLayout

#line default
#line hidden
#nullable disable
    ))]
    [global::Microsoft.AspNetCore.Components.RouteAttribute(
    // language=Route,Component
#nullable restore
#line (1,7)-(1,48) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
"/Account/Manage/TwoFactorAuthentication"

#line default
#line hidden
#nullable disable
    )]
    #nullable restore
    public partial class TwoFactorAuthentication : global::Microsoft.AspNetCore.Components.ComponentBase
    #nullable disable
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(global::Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
            __builder.OpenComponent<global::Microsoft.AspNetCore.Components.Web.PageTitle>(0);
            __builder.AddAttribute(1, "ChildContent", (global::Microsoft.AspNetCore.Components.RenderFragment)((__builder2) => {
                __builder2.AddContent(2, "Two-factor authentication (2FA)");
            }
            ));
            __builder.CloseComponent();
            __builder.AddMarkupContent(3, "\r\n\r\n");
            __builder.OpenComponent<global::Hoteldia.Components.Account.Shared.StatusMessage>(4);
            __builder.CloseComponent();
            __builder.AddMarkupContent(5, "\r\n");
            __builder.AddMarkupContent(6, "<h3>Two-factor authentication (2FA)</h3>");
#nullable restore
#line (16,2)-(22,1) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
if (canTrack)
{
    if (is2faEnabled)
    {
        if (recoveryCodesLeft == 0)
        {

#line default
#line hidden
#nullable disable

            __builder.AddMarkupContent(7, "<div class=\"alert alert-danger\"><strong>You have no recovery codes left.</strong>\r\n                <p>You must <a href=\"Account/Manage/GenerateRecoveryCodes\">generate a new set of recovery codes</a> before you can log in with a recovery code.</p></div>");
#nullable restore
#line (26,1)-(29,1) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
        }
        else if (recoveryCodesLeft == 1)
        {

#line default
#line hidden
#nullable disable

            __builder.AddMarkupContent(8, "<div class=\"alert alert-danger\"><strong>You have 1 recovery code left.</strong>\r\n                <p>You can <a href=\"Account/Manage/GenerateRecoveryCodes\">generate a new set of recovery codes</a>.</p></div>");
#nullable restore
#line (33,1)-(36,1) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
        }
        else if (recoveryCodesLeft <= 3)
        {

#line default
#line hidden
#nullable disable

            __builder.OpenElement(9, "div");
            __builder.AddAttribute(10, "class", "alert alert-warning");
            __builder.OpenElement(11, "strong");
            __builder.AddContent(12, "You have ");
#nullable restore
#line (37,35)-(37,52) 25 "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
__builder.AddContent(13, recoveryCodesLeft

#line default
#line hidden
#nullable disable
            );
            __builder.AddContent(14, " recovery codes left.");
            __builder.CloseElement();
            __builder.AddMarkupContent(15, "\r\n                ");
            __builder.AddMarkupContent(16, "<p>You should <a href=\"Account/Manage/GenerateRecoveryCodes\">generate a new set of recovery codes</a>.</p>");
            __builder.CloseElement();
#nullable restore
#line (40,1)-(44,1) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
        }

        if (isMachineRemembered)
        {

#line default
#line hidden
#nullable disable

            __builder.OpenElement(17, "form");
            __builder.AddAttribute(18, "style", "display: inline-block");
            string __formName = global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<string>("forget-browser");
            __builder.AddAttribute(19, "onsubmit", global::Microsoft.AspNetCore.Components.EventCallback.Factory.Create<global::System.EventArgs>(this, 
#nullable restore
#line (44,87)-(44,113) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
OnSubmitForgetBrowserAsync

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(20, "method", "post");
            __builder.AddNamedEvent("onsubmit", __formName);
            __builder.OpenComponent<global::Microsoft.AspNetCore.Components.Forms.AntiforgeryToken>(21);
            __builder.CloseComponent();
            __builder.AddMarkupContent(22, "\r\n                ");
            __builder.AddMarkupContent(23, "<button type=\"submit\" class=\"btn btn-primary\">Forget this browser</button>");
            __builder.CloseElement();
#nullable restore
#line (48,1)-(50,1) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
        }


#line default
#line hidden
#nullable disable

            __builder.AddMarkupContent(24, "<a href=\"Account/Manage/Disable2fa\" class=\"btn btn-primary\">Disable 2FA</a>\r\n        ");
            __builder.AddMarkupContent(25, "<a href=\"Account/Manage/GenerateRecoveryCodes\" class=\"btn btn-primary\">Reset recovery codes</a>");
#nullable restore
#line (52,1)-(54,1) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
    }


#line default
#line hidden
#nullable disable

            __builder.AddMarkupContent(26, "<h4>Authenticator app</h4>");
#nullable restore
#line (55,1)-(55,5) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
    

#line default
#line hidden
#nullable disable

#nullable restore
#line (55,6)-(57,1) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
if (!hasAuthenticator)
    {

#line default
#line hidden
#nullable disable

            __builder.AddMarkupContent(27, "<a href=\"Account/Manage/EnableAuthenticator\" class=\"btn btn-primary\">Add authenticator app</a>");
#nullable restore
#line (58,1)-(61,1) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
    }
    else
    {

#line default
#line hidden
#nullable disable

            __builder.AddMarkupContent(28, "<a href=\"Account/Manage/EnableAuthenticator\" class=\"btn btn-primary\">Set up authenticator app</a>\r\n        ");
            __builder.AddMarkupContent(29, "<a href=\"Account/Manage/ResetAuthenticator\" class=\"btn btn-primary\">Reset authenticator app</a>");
#nullable restore
#line (63,1)-(63,6) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
    }

#line default
#line hidden
#nullable disable

#nullable restore
#line (63,6)-(67,1) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"

}
else
{

#line default
#line hidden
#nullable disable

            __builder.AddMarkupContent(30, "<div class=\"alert alert-danger\"><strong>Privacy and cookie policy have not been accepted.</strong>\r\n        <p>You must accept the policy before you can enable two factor authentication.</p></div>");
#nullable restore
#line (71,1)-(72,1) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
}

#line default
#line hidden
#nullable disable

        }
        #pragma warning restore 1998
#nullable restore
#line (73,8)-(101,1) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"

    private bool canTrack;
    private bool hasAuthenticator;
    private int recoveryCodesLeft;
    private bool is2faEnabled;
    private bool isMachineRemembered;

    [CascadingParameter]
    private HttpContext HttpContext { get; set; } = default!;

    protected override async Task OnInitializedAsync()
    {
        var user = await UserAccessor.GetRequiredUserAsync(HttpContext);
        canTrack = HttpContext.Features.Get<ITrackingConsentFeature>()?.CanTrack ?? true;
        hasAuthenticator = await UserManager.GetAuthenticatorKeyAsync(user) is not null;
        is2faEnabled = await UserManager.GetTwoFactorEnabledAsync(user);
        isMachineRemembered = await SignInManager.IsTwoFactorClientRememberedAsync(user);
        recoveryCodesLeft = await UserManager.CountRecoveryCodesAsync(user);
    }

    private async Task OnSubmitForgetBrowserAsync()
    {
        await SignInManager.ForgetTwoFactorClientAsync();

        RedirectManager.RedirectToCurrentPageWithStatus(
            "The current browser has been forgotten. When you login again from this browser you will be prompted for your 2fa code.",
            HttpContext);
    }

#line default
#line hidden
#nullable disable

        [global::Microsoft.AspNetCore.Components.InjectAttribute] private 
#nullable restore
#line (10,9)-(10,32) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
IdentityRedirectManager

#line default
#line hidden
#nullable disable
         
#nullable restore
#line (10,33)-(10,48) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
RedirectManager

#line default
#line hidden
#nullable disable
         { get; set; }
         = default!;
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private 
#nullable restore
#line (9,9)-(9,29) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
IdentityUserAccessor

#line default
#line hidden
#nullable disable
         
#nullable restore
#line (9,30)-(9,42) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
UserAccessor

#line default
#line hidden
#nullable disable
         { get; set; }
         = default!;
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private 
#nullable restore
#line (8,9)-(8,39) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
SignInManager<ApplicationUser>

#line default
#line hidden
#nullable disable
         
#nullable restore
#line (8,40)-(8,53) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
SignInManager

#line default
#line hidden
#nullable disable
         { get; set; }
         = default!;
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private 
#nullable restore
#line (7,9)-(7,37) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
UserManager<ApplicationUser>

#line default
#line hidden
#nullable disable
         
#nullable restore
#line (7,38)-(7,49) "C:\Users\srrex\Desktop\Proyecto\HoteldiaServer\Hoteldia\Components\Account\Pages\Manage\TwoFactorAuthentication.razor"
UserManager

#line default
#line hidden
#nullable disable
         { get; set; }
         = default!;
    }
}
#pragma warning restore 1591
