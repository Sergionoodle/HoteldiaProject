@page "/crear-habitacion/{propiedadId:int}"
@using Hoteldia.Modelos.DTO
@using Hoteldia.Repositorio.IRespositorio
@inject IHabitacionRepositorio HabitacionRepositorio
@inject NavigationManager NavigationManager

<h3>Crear Habitación</h3>

<EditForm Model="habitacion" OnValidSubmit="CrearHabitacion">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="mb-3">
        <label>Nombre</label>
        <InputText @bind-Value="habitacion.Nombre" class="form-control" />
    </div>

    <div class="mb-3">
        <label>Precio por noche</label>
        <InputNumber @bind-Value="habitacion.PrecioPorNoche" class="form-control" />
    </div>

    <div class="mb-3">
        <label>Cantidad disponible</label>
        <InputNumber @bind-Value="habitacion.CantidadDisponible" class="form-control" />
    </div>

    <div class="mb-3">
        <label>Descripción</label>
        <InputTextArea @bind-Value="habitacion.Descripcion" class="form-control" />
    </div>

    <button type="submit" class="btn btn-primary">Guardar</button>
    <button type="button" class="btn btn-secondary" @onclick="Cancelar">Cancelar</button>
</EditForm>

@code {
    [Parameter] public int propiedadId { get; set; }
    private HabitacionDTO habitacion = new();

    protected override void OnParametersSet()
    {
        habitacion.PropiedadId = propiedadId;
    }

    private async Task CrearHabitacion()
    {
        await HabitacionRepositorio.CrearHabitacion(habitacion);
        NavigationManager.NavigateTo($"/habitaciones/{propiedadId}");
    }

    private void Cancelar()
    {
        NavigationManager.NavigateTo($"/habitaciones/{propiedadId}");
    }
}
